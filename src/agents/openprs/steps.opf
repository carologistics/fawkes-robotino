;---------------------------------------------------------------------------
;  steps.opf - OpenPRS OP file for RCll2017 openprs-agent
;
;  Created: Fri Jan 27 11:50:00 2017
;  Copyright  2017  Mostafa Gomaa [gomaa@kbsg.rwth-aachen.de]
;  Licensed under GPLv2+ license, cf. LICENSE file
;---------------------------------------------------------------------------

(
	(defop step-drive-to
		:invocation( ! (step drive-to machine $mps-name side $side) )
		:context()  
		:body(
			(! (printf (Format "STEP: Drive-To .. machine %s is %s \n" $mps-name  $m-s)))
			(=> (agent-state STEP-RUNNING))
			;Sides allowed
			(? (MEMQ $side (. "input" "output" .)))
			(if (? (= $side "input" ))
				(! (= $place (string-cat $mps-name "-I")))
				else 
				(! (= $place (string-cat $mps-name "-O")))
				)

			(if (! (execute (skill "drive_to" "place" $place) )) 
				(=> (agent-state STEP-FINISHD))
				else
				(=> (agent-state STEP-FAILD)) )
			)
		)


	)