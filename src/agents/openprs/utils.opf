;---------------------------------------------------------------------------
;  utils.opf - OpenPRS OP file for RCll2017 openprs-agent
;
;  Created: Tue Mar 17 09:43:00 2017
;  Copyright  2017  Mostafa Gomaa [gomaa@kbsg.rwth-aachen.de]
;  Licensed under GPLv2+ license, cf. LICENSE file
;---------------------------------------------------------------------------

(

	(defop calc-dist-point-squared
		:invocation (! (CAL_SQUARE_DISTANCE $x1 $y1 $x2 $y2 $res))
		:body (
		       (! (= $res (+ (* (- $x1 $x2) (- $x1 $x2)) (* (- $y1 $y2) (- $y1 $y2)))))
		      )
		:documentation "Calculates distance between to single points in the plain"
	)



	(defop waitsec
	  :invocation (! (waitsec $time $name))
	  :context ((time $secn $usecn))
	  :body (
	         (=> (wait $name $time $secn $usecn))
	  ) 
	  :documentation "Makes the agent wait inside an op for $time seconds
	                  Usage : Post Goal, and wait for fact  (wait-done) which will
	                  be asserted exactly after $time seconds passed. (wait-done) facts
	                  needs to be deleted manually
	                  Secondly one can check for presence of the 
	                  (wait $name $time $sec $usec) predicate"

	)

	(defop waiting
	 :invocation (time $sec $usec)
	 :context ((wait $name $time $secn $usecn)
	           (timeout $sec $usec $secn $usecn $time))
	 :body ((~> (wait $name $time $secn $usecn))
	        (=> (wait-done $name)) 
	       )
	 :documentation "Helper OP for waitsec OP"
	)

	)