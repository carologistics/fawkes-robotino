;---------------------------------------------------------------------------
;  pentester.clp - utilities needed for executive rcll agent
;
;  Created: Fri 19 Jul 2024 01:15:00 AM CEST
;  Copyright  2024  Daniel Swoboda <daniel.swoboda@ml.rwth-aachen.de>
;  Licensed under GPLv2+ license, cf. LICENSE file in the doc directory.
;---------------------------------------------------------------------------

; This program is free software; you can redistribute it and/or modify
; it under the terms of the GNU General Public License as published by
; the Free Software Foundation; either version 2 of the License, or
; (at your option) any later version.
;
; This program is distributed in the hope that it will be useful,
; but WITHOUT ANY WARRANTY; without even the implied warranty of
; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
; GNU Library General Public License for more details.
;
; Read the full text in the LICENSE.GPL file in the doc directory.


(defglobal
	?*FAIL-TRIGGER-SALIENCE* = 5000
)


(defrule pentester-fail-random-plan-action
	(declare (salience ?*FAIL-TRIGGER-SALIENCE*))
    ?pa <- (plan-action (id ?id) (goal-id ?goal) (state PENDING))
    =>
    (bind ?random (random 0 100))
    (if (> ?random 90) then
        (printout t "Pentester: Randomly failing plan-action " ?id ?goal crlf)
        (modify ?pa (state FAILED))
    )
)
