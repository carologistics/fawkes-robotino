%YAML 1.2
%TAG ! tag:fawkesrobotics.org,navgraph/
---
graph-name: LLSF
root: SW

default-properties:
    # Max. distance between actual and target positions to deem the target
    # reached. This value is for intermediate nodes on a path; m
    # The value can be overwritten per node in the graph file.
    - travel_tolerance: 0.7

    # Max. distance between actual and target positions to deem the target
    # reached. This value is for the last node on a path; m
    # The value can be overwritten per node in the graph file.
    - target_tolerance: 0.7

    # Max. distance between actual and target orientation to deem the target
    # reached. This value is for the last node on a path; rad
    - orientation_tolerance: 0.6

    # When following a plan the robot will check all upcoming nodes if they
    # are close to the robot within this tolerance. If so, they take a shortcut
    # and will go to the node in the plan after the shortcut node.
    # This is potentially dangerous depending on the graph and navigator as it
    # might violate the typical graph constraint of only having direct-line-of-tavel
    # connections. The value can be overidden with a node property of the same name; m
    - shortcut_tolerance: 1.2

    # Distance from base_link to the MPS to align
    - align_distance: 0.5

    # Signal position on the table. Z is the table height above ground.
    - signal_hint_x: 0.035
    - signal_hint_y: -0.1
    - signal_hint_z: 0.78

nodes:

# Default point, used only for mps_detect_signal when no or an invalid place= is given
  - !unconnected
    name: place-default
    pos: [1, 1]
    properties:
      - only-copy-properties


# Exploration Points
# two points for each cell, so for each mps rotation at least one point can see the tag
# cyan half:

  - name: Exp-CM1
    pos: [0.0, 1.5]
    properties:
      - orientation_Z1:  -0.9
      - orientation_Z13: -2.4
  - name: Exp-CM2
    pos: [0.0, 3.0]
    properties:
      - orientation_Z3:   0.9
      - orientation_Z15:  2.4
  - name: Exp-CM3
    pos: [0.0, 4.5]
    properties:
      - orientation_Z4:   0.9
      - orientation_Z16:  2.4

  - name: Exp-C1
    pos: [2.0, 1.5]
    properties:
      - orientation_Z1:  -2.4
      - orientation_Z2:   2.4
  - name: Exp-C2
    pos: [2.0, 3.0]
    properties:
      - orientation_Z2:  -2.4
      - orientation_Z3:   2.4
      - orientation_Z6:  -0.9
  - name: Exp-C3
    pos: [2.0, 4.5]
    properties:
      - orientation_Z4:   2.4
      - orientation_Z7:  -0.9
      - orientation_Z8:   0.9

  - name: Exp-C4
    pos: [3.5, 0.5]
    properties:
      - orientation_Z5:   2.4
  - name: Exp-C5
    pos: [4.0, 1.5]
    properties:
      - orientation_Z5:  -2.4
      - orientation_Z9:  -0.9
  - name: Exp-C6
    pos: [4.0, 3.0]
    properties:
      - orientation_Z6:  -2.4
      - orientation_Z10: -0.9
  - name: Exp-C7
    pos: [4.0, 4.5]
    properties:
      - orientation_Z7: -2.4
      - orientation_Z8:  2.4
      - orientation_Z11: -0.9
      - orientation_Z12: 0.5
  - name: Exp-C8
    pos: [4.0, 5.5]
    properties:
      - orientation_Z12: -0.9

  - name: Exp-C9
    pos: [5.5, 1.5]
    properties:
      - orientation_Z9: -2.4
  - name: Exp-C10
    pos: [5.5, 3.0]
    properties:
      - orientation_Z10: -2.4
  - name: Exp-C11
    pos: [5.5, 4.5]
    properties:
      - orientation_Z11: -2.4
# magenta half

  - name: Exp-M1
    pos: [-2.0, 1.5]
    properties:
      - orientation_Z13:  -2.4
      - orientation_Z14:   2.4
  - name: Exp-M2
    pos: [-2.0, 3.0]
    properties:
      - orientation_Z14:  -2.4
      - orientation_Z15:   2.4
      - orientation_Z18:  -0.9
  - name: Exp-M3
    pos: [-2.0, 4.5]
    properties:
      - orientation_Z16:   2.4
      - orientation_Z19:  -0.9
      - orientation_Z20:   0.9

  - name: Exp-M4
    pos: [-3.5, 0.5]
    properties:
      - orientation_Z17:   2.4
  - name: Exp-M5
    pos: [-4.0, 1.5]
    properties:
      - orientation_Z17:  -2.4
      - orientation_Z21:  -0.9
  - name: Exp-M6
    pos: [-4.0, 3.0]
    properties:
      - orientation_Z18:  -2.4
      - orientation_Z22: -0.9
  - name: Exp-M7
    pos: [-4.0, 4.5]
    properties:
      - orientation_Z19: -2.4
      - orientation_Z20:  2.4
      - orientation_Z23: -0.9
      - orientation_Z24: 0.5
  - name: Exp-M8
    pos: [-4.0, 5.5]
    properties:
      - orientation_Z24: -0.9

  - name: Exp-M9
    pos: [-5.5, 1.5]
    properties:
      - orientation_Z21: -2.4
  - name: Exp-M10
    pos: [-5.5, 3.0]
    properties:
      - orientation_Z22: -2.4
  - name: Exp-M11
    pos: [-5.5, 4.5]
    properties:
      - orientation_Z23: -2.4

# drive into field points
# Cyan
  - !unconnected
    name: C-ins-out
    pos: [3.3, -0.55]
    properties:
      - orientation: 1.57
      - always-copy: true
  - !unconnected
    name: C-ins-in
    pos: [3.3, 0.75]
    properties:
      - always-copy: true
# Magenta
  - !unconnected
    name: M-ins-out
    pos: [-3.3, -0.55]
    properties:
      - orientation: 1.57
      - always-copy: true
  - !unconnected
    name: M-ins-in
    pos: [-3.3, 0.75]
    properties:
      - always-copy: true

# wait points
  - !unconnected
    name: WAIT1
    pos : [0,1]
    properties:
      - orientation: 1.57
      - always-copy: true
      - target_tolerance: 1.5

# Machine points for property generation
# Positions will be written by the generator
# Cyan
  - !unconnected
    name: C-CS1
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 1
      - tag_output: 2
      - input_offset_y: -0.02
      - output_offset_y: -0.01
  - !unconnected
    name: C-CS2
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 17
      - tag_output: 18
  - !unconnected
    name: C-RS1
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 33
      - tag_output: 34
  - !unconnected
    name: C-RS2
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 177
      - tag_output: 178
  - !unconnected
    name: C-BS
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 65
      - tag_output: 66
      - input_offset_y: 0
      - output_offset_y: -0.01
  - !unconnected
    name: C-DS
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 81
      - tag_output: 82
      - input_offset_y: -0.02
      - output_offset_y: 0
#Magenta
  - !unconnected
    name: M-CS1
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 97
      - tag_output: 98
  - !unconnected
    name: M-CS2
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 113
      - tag_output: 114
  - !unconnected
    name: M-RS1
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 129
      - tag_output: 130
  - !unconnected
    name: M-RS2
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 145
      - tag_output: 146
  - !unconnected
    name: M-BS
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 161
      - tag_output: 162
  - !unconnected
    name: M-DS
    pos: [0, 0]
    properties:
      - only-copy-properties
      - tag_input: 49
      - tag_output: 50

# Possible directional tags:
# !bidir (bidirectional, default), !dir (directed)
connections:
# common
# connecting edges in Y direction
  - [Exp-CM1,  Exp-CM2]
  - [Exp-CM2,  Exp-CM3]

# cyan half
  # connecting edges in Y direction
  - [Exp-C1,  Exp-C2]
  - [Exp-C2,  Exp-C3]
  - [Exp-C4,  Exp-C5]
  - [Exp-C5,  Exp-C6]
  - [Exp-C6,  Exp-C7]
  - [Exp-C7, Exp-C8]
  - [Exp-C9, Exp-C10]
  - [Exp-C10, Exp-C11]

  # connecting edges in X direction
  - [Exp-CM1,  Exp-C1]
  - [Exp-CM2,  Exp-C2]
  - [Exp-CM3,  Exp-C3]
  - [Exp-C1,  Exp-C4]
  - [Exp-C1,  Exp-C5]
  - [Exp-C2,  Exp-C6]
  - [Exp-C3,  Exp-C7]
  - [Exp-C3,  Exp-C8]
  - [Exp-C4,  Exp-C9]
  - [Exp-C5,  Exp-C9]
  - [Exp-C6,  Exp-C10]
  - [Exp-C7,  Exp-C11]
  - [Exp-C8,  Exp-C11]

  # connecting edges in Y direction
  - [Exp-M1,  Exp-M2]
  - [Exp-M2,  Exp-M3]
  - [Exp-M4,  Exp-M5]
  - [Exp-M5,  Exp-M6]
  - [Exp-M6,  Exp-M7]
  - [Exp-M7, Exp-M8]
  - [Exp-M9, Exp-M10]
  - [Exp-M10, Exp-M11]

  # connecting edges in X direction
  - [Exp-CM1,  Exp-M1]
  - [Exp-CM2,  Exp-M2]
  - [Exp-CM3,  Exp-M3]
  - [Exp-M1,  Exp-M4]
  - [Exp-M1,  Exp-M5]
  - [Exp-M2,  Exp-M6]
  - [Exp-M3,  Exp-M7]
  - [Exp-M3,  Exp-M8]
  - [Exp-M4,  Exp-M9]
  - [Exp-M5,  Exp-M9]
  - [Exp-M6,  Exp-M10]
  - [Exp-M7,  Exp-M11]
  - [Exp-M8,  Exp-M11]

